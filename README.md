# Linux-Proc-Kernel-Module

This linux kernel module creates a proc file called /proc/kmlab/status that the user app can read and write to. Upon writing its process id (PID) to the procfile, the kernel module starts keeping track of that processes run time, which is then written to the proc file. There are several main steps to this process. I define a custom proc write implementation that appends to the procfile. Upon receiving a buffer from the userspace the PID is written to the procfile along with the process runtime. The PID is then added to a linked list via a function called add_pid. This kernel module also supports multiple user processes running concurrently. Every 5 seconds, a timer function is called. When the timer is called, a function to update the process cpu use of every currently running process is called. This function is scheduled using a workqueue to execute as soon as possible. It iterates through the PID list and updates that PIDs cpu usage. That new usage is then appended to /proc/kmlab/status. If the PID is terminated, it is removed from the list. All list operations are protected using dynamic spinlocks to prevent race conditions. Finally, the module exit function is called when the module is unloaded, which deallocates memory for the timer, workqueue, linked lists, and the proc files and directories which were created in the kernel module. Throughout the kernel module, I use different checks to protect against buffer overwrites. The runtimes of the user applications can be viewed using cat /proc/kmlab/status.